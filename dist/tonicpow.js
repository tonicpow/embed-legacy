!function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var a=class{constructor(e){for(let t in e)this[t]=e[t]}static get schema(){return{B:{},MAP:{},in:[]}}get bImgDataSrc(){if(this.B&&"binary"===this.B.encoding)return"data:"+this.B["content-type"]+";base64, "+this.B.content}get adType(){return this.MAP&&this.MAP.ad_type&&"funding"===this.MAP.ad_type?"funding":"display"}get ctaUrl(){if(this.MAP&&this.MAP.cta_url)return this.MAP.cta_url}get ctaText(){return this.MAP&&this.MAP.cta_text?this.MAP.cta_text:"Donate"}get affiliateAddress(){if(this.MAP&&this.MAP.affiliate_address&&"00"!==this.MAP.affiliate_address)return this.MAP.affiliate_address}get currency(){return this.MAP&&this.MAP.currency?this.MAP.currency:"usd"}get firstVinAddress(){if(this.in&&this.in[0]&&this.in[0].e.a)return this.in[0].e.a}};const n={removeStorage:e=>{try{localStorage.removeItem(e),localStorage.removeItem(e+"_expiresIn")}catch(t){return console.log("removeStorage: Error removing key ["+e+"] from localStorage: "+JSON.stringify(t)),!1}return!0},getStorage:e=>{let t=Date.now(),r=localStorage.getItem(e+"_expires");if(null==r&&(r=0),r<t)return n.removeStorage(e),null;try{return localStorage.getItem(e)}catch(t){return console.log("getStorage: Error reading key ["+e+"] from localStorage: "+JSON.stringify(t)),null}},setStorage:(e,t,r=null)=>{r=r?Math.abs(r):86400;let a=Date.now()+1e3*r;try{localStorage.setItem(e,t),localStorage.setItem(e+"_expires",a)}catch(t){return console.log("setStorage: Error setting key ["+e+"] in localStorage: "+JSON.stringify(t)),!1}return!0}};var o=n;const i={lookup:async e=>{if(!e||!e.includes("$"))return console.error("invalid handcash handle: "+e),"";let t=o.getStorage(e);if(null!==t&&t.length>25)return console.log("handcash found locally, skipping lookup! "+e+":"+t),t;try{let r=await Promise.all([fetch("https://api.handcash.io/api/receivingAddress/"+e.substr(1)).then(e=>e.json())]);return"object"==typeof r&&r[0]&&r[0].hasOwnProperty("receivingAddress")?(t=r[0].receivingAddress).length>25?(o.setStorage(e,t,7200),t):(console.log("receivingAddress was invalid:",t,r),""):(console.log("handcash response was invalid or missing receivingAddress",r),"")}catch(t){return console.log(t,e),""}}};var s=i;const l={lookup:async e=>{if(!e||"1"!==e.charAt(0))return console.error("invalid relay handle: "+e),"";let t=o.getStorage(e);if(null!==t&&t.length>25)return console.log("relay found locally, skipping lookup! "+e+":"+t),t;try{let r=await Promise.all([fetch("https://relayx.io/api/receivingAddress/"+e).then(e=>e.json())]);return"object"==typeof r&&r[0]&&r[0].hasOwnProperty("receivingAddress")?(t=r[0].receivingAddress).length>25?(o.setStorage(e,t,7200),t):(console.log("receivingAddress was invalid:",t,r),""):(console.log("relay response was invalid or missing receivingAddress",r),"")}catch(t){return console.log(t,e),""}}};var d=l;let c={};c.Storage=o,c.Handcash=s,c.Relay=d,c.Tonic=a,c.Iframes=new Map,c.iframeLoader=(async()=>{const e=["bsv","usd"];let t=document.head.querySelector("[name=bitcoin-address][content]")?document.head.querySelector("[name=bitcoin-address][content]").content:"",r=document.head.querySelector("[name=bitcoin-tx][content]")?document.head.querySelector("[name=bitcoin-tx][content]").content:"",a=new URLSearchParams(window.location.search).get("affiliate");a&&(void 0===(a="1"===(a=a.includes("$")?await s.lookup(a):a).charAt(0)&&a.length<25?await d.lookup(a):a)||!a||""===a||a.length<=25)&&(console.error("failed to set affiliate",a),a="");let n=document.getElementsByClassName("tonic");if(n&&0!==n.length){for(let o=n.length-1;o>=0;o--){let i=n[o],l=i.getAttribute("data-width");l&&""!==l||(l=300);let u=i.getAttribute("data-height");u&&""!==u||(u=250);let g=i.getAttribute("data-unit-id");g&&""!==g||(console.log("data-unit-id not found, using default: embed-1"),g="embed-1");let h=i.getAttribute("data-address"),f=i.getAttribute("data-handcash"),m="";f&&f.includes("$")?void 0===(m=await s.lookup(f))||!m||""===m||m.length<=25?m="":h=m:f="";let p=i.getAttribute("data-relayx"),y="";p&&"1"===p.charAt(0)?void 0===(y=await d.lookup(p))||!y||""===y||y.length<=25?y="":h=y:p="",(void 0===h||!h||h.length<=25)&&(t?(h=t,console.log("data-address not found or invalid: "+h+" using sticker address: "+t+" tonic-id: "+g)):(h="1LWyDs4qzmfAhGpSZk1K1kLmNdafBDdJSD",console.log("data-address not found or invalid: "+h+" using default address: 1LWyDs4qzmfAhGpSZk1K1kLmNdafBDdJSD tonic-id: "+g)));let A=localStorage.getItem("affiliate_"+h);A?(a=A,console.log("existing affiliate found in local storage: "+a)):a&&(localStorage.setItem("affiliate_"+h,a),console.log("saving new affiliate in local storage: "+a));let b=i.getAttribute("data-rate");b&&""!==b||(b=546);let v=i.getAttribute("data-image");v&&""!==v||(v="");let S=i.getAttribute("data-link-color");S&&""!==S?6!==(S=S.replace(/[^a-zA-Z]+/g,"")).length&&3!==S.length&&(S=""):S="";let w=i.getAttribute("data-currency");w&&""!==w?-1===e.indexOf(w)&&(w="bsv",b=546):w="bsv",w=w.toLowerCase();let P=document.createElement("iframe");P.src="https://app.tonicpow.com/?unit_id="+g+"&address="+h+(a?"&affiliate="+a:"")+(t?"&sticker_address="+t:"")+(r?"&sticker_tx="+r:"")+"&rate="+b+"&currency="+w+"&width="+l+"&height="+u+(v?"&image="+v:"")+(S?"&link_color="+S:"")+"&cache="+Math.random(),P.width=l,P.height=parseInt(u)+28,P.id="tonic_"+g,P.setAttribute("scrolling","no"),P.setAttribute("data-unit-id",g),P.setAttribute("data-address",h),a&&P.setAttribute("data-affiliate",a),P.setAttribute("data-sticker-address",t),P.setAttribute("data-sticker-tx",r),P.setAttribute("data-handcash",f),P.setAttribute("data-relayx",p),P.setAttribute("data-link-color",S),P.importance="high",P.frameBorder="0",P.style.border="none",P.style.overflow="hidden",P.style.backgroundColor="transparent",P.allowTransparency="true",c.Iframes.set(g,h),i.parentNode.replaceChild(P,i)}console.log("Tonic Map:",c.Iframes)}else console.info("no tonic divs found with class 'tonic'")}),c.load=(()=>{c.iframeLoader();fetch("https://b.map.sv/ping/").then(e=>e.json()).then(async e=>{})}),"complete"===document.readyState||"interactive"===document.readyState?(c.load(),console.log("loaded via document.readyState")):document.addEventListener("DOMContentLoaded",function(){c.load(),console.log("loaded via DOMContentLoaded")}),window.TonicPow=c}]);