!function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var a=class{constructor(e){for(let t in e)this[t]=e[t]}static get schema(){return{B:{},MAP:{},in:[]}}get bImgDataSrc(){if(this.B&&"binary"===this.B.encoding)return"data:"+this.B["content-type"]+";base64, "+this.B.content}get adType(){return this.MAP&&this.MAP.ad_type&&"funding"===this.MAP.ad_type?"funding":"display"}get ctaUrl(){if(this.MAP&&this.MAP.cta_url)return this.MAP.cta_url}get ctaText(){return this.MAP&&this.MAP.cta_text?this.MAP.cta_text:"Donate"}get affiliateAddress(){if(this.MAP&&this.MAP.affiliate_address&&"00"!==this.MAP.affiliate_address)return this.MAP.affiliate_address}get currency(){return this.MAP&&this.MAP.currency?this.MAP.currency:"usd"}get firstVinAddress(){if(this.in&&this.in[0]&&this.in[0].e.a)return this.in[0].e.a}};const n={removeStorage:e=>{try{localStorage.removeItem(e),localStorage.removeItem(e+"_expiresIn")}catch(t){return console.log("removeStorage: Error removing key ["+e+"] from localStorage: "+JSON.stringify(t)),!1}return!0},getStorage:e=>{let t=Date.now(),r=localStorage.getItem(e+"_expires");if(null==r&&(r=0),r<t)return n.removeStorage(e),null;try{return localStorage.getItem(e)}catch(t){return console.log("getStorage: Error reading key ["+e+"] from localStorage: "+JSON.stringify(t)),null}},setStorage:(e,t,r=null)=>{r=r?Math.abs(r):86400;let a=Date.now()+1e3*r;try{localStorage.setItem(e,t),localStorage.setItem(e+"_expires",a)}catch(t){return console.log("setStorage: Error setting key ["+e+"] in localStorage: "+JSON.stringify(t)),!1}return!0}};var o=n;const i={lookup:async e=>{if(!e||!e.includes("$"))return console.error("invalid handcash handle: "+e),"";let t=o.getStorage(e);if(null!==t&&t.length>25)return console.log("handcash found locally, skipping lookup! "+e+":"+t),t;try{let r=await Promise.all([fetch("https://api.handcash.io/api/receivingAddress/"+e.substr(1)).then(e=>e.json())]);return"object"==typeof r&&r[0]&&r[0].hasOwnProperty("receivingAddress")?(t=r[0].receivingAddress).length>25?(o.setStorage(e,t,7200),t):(console.log("receivingAddress was invalid:",t,r),""):(console.log("handcash response was invalid or missing receivingAddress",r),"")}catch(t){return console.log(t,e),""}}};var s=i;let l={};l.Storage=o,l.Handcash=s,l.Tonic=a,l.Iframes=new Map,l.iframeLoader=(async()=>{const e=["bsv","usd"];let t=document.head.querySelector("[name=bitcoin-address][content]")?document.head.querySelector("[name=bitcoin-address][content]").content:"",r=document.head.querySelector("[name=bitcoin-tx][content]")?document.head.querySelector("[name=bitcoin-tx][content]").content:"",a=new URLSearchParams(window.location.search).get("affiliate");a&&(void 0===(a=a.includes("$")?await s.lookup(a):a)||!a||""===a||a.length<=25)&&(console.error("failed to set affiliate",a),a="");let n=document.getElementsByClassName("tonic");if(n&&0!==n.length){for(let o=n.length-1;o>=0;o--){let i=n[o],d=i.getAttribute("data-width");d&&""!==d||(d=300);let c=i.getAttribute("data-height");c&&""!==c||(c=250);let u=i.getAttribute("data-unit-id");u&&""!==u||(console.log("data-unit-id not found, using default: embed-1"),u="embed-1");let g=i.getAttribute("data-address");(void 0===g||!g||g.length<=25)&&(t?(g=t,console.log("data-address not found or invalid: "+g+" using sticker address: "+t)):(g="1LWyDs4qzmfAhGpSZk1K1kLmNdafBDdJSD",console.log("data-address not found or invalid: "+g+" using default address: 1LWyDs4qzmfAhGpSZk1K1kLmNdafBDdJSD")));let f=i.getAttribute("data-handcash"),h="";f&&f.includes("$")&&(void 0===(h=await s.lookup(f))||!h||""===h||h.length<=25?h="":g=h);let m=localStorage.getItem("affiliate_"+g);m?(a=m,console.log("existing affiliate found in local storage: "+a)):a&&(localStorage.setItem("affiliate_"+g,a),console.log("saving new affiliate in local storage: "+a));let p=i.getAttribute("data-rate");p&&""!==p||(p=546);let y=i.getAttribute("data-image");y&&""!==y||(y="");let b=i.getAttribute("data-link-color");b&&""!==b?6!==(b=b.replace(/[^a-zA-Z]+/g,"")).length&&3!==b.length&&(b=""):b="";let A=i.getAttribute("data-currency");A&&""!==A?-1===e.indexOf(A)&&(A="bsv",p=546):A="bsv",A=A.toLowerCase();let S=document.createElement("iframe");S.src="https://app.tonicpow.com/?unit_id="+u+"&address="+g+(a?"&affiliate="+a:"")+(t?"&sticker_address="+t:"")+(r?"&sticker_tx="+r:"")+"&rate="+p+"&currency="+A+"&width="+d+"&height="+c+(y?"&image="+y:"")+(b?"&link_color="+b:"")+"&cache="+Math.random(),S.width=d,S.height=parseInt(c)+28,S.id="tonic_"+u,S.setAttribute("scrolling","no"),S.setAttribute("data-unit-id",u),S.setAttribute("data-address",g),a&&S.setAttribute("data-affiliate",a),S.setAttribute("data-sticker-address",t),S.setAttribute("data-sticker-tx",r),S.setAttribute("data-handcash",f),S.setAttribute("data-link-color",b),S.importance="high",S.frameBorder="0",S.style.border="none",S.style.overflow="hidden",S.style.backgroundColor="transparent",S.allowTransparency="true",l.Iframes.set(u,g),i.parentNode.replaceChild(S,i)}console.log("Tonic Map:",l.Iframes)}else console.info("no tonic divs found with class 'tonic'")}),l.load=(()=>{l.iframeLoader();fetch("https://b.map.sv/ping/").then(e=>e.json()).then(async e=>{console.log("r")})}),"complete"===document.readyState||"interactive"===document.readyState?(l.load(),console.log("loaded via document.readyState")):document.addEventListener("DOMContentLoaded",function(){l.load(),console.log("loaded via DOMContentLoaded")}),window.TonicPow=l}]);